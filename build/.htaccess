# --- UTF-8 for text files ---
AddDefaultCharset UTF-8
<IfModule mod_mime.c>
  AddCharset UTF-8 .txt
</IfModule>

# --- Prevent caching of entry HTML ---
<IfModule mod_headers.c>
  <FilesMatch "\.(html)$">
    Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header set Pragma "no-cache"
    Header set Expires "0"
  </FilesMatch>

  # Cache static build assets long-term
  <FilesMatch "\.(js|css|woff2|png|jpg|jpeg|svg|webp)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>
</IfModule>

# --- SPA routing fallback for SvelteKit ---
<IfModule mod_rewrite.c>
  RewriteEngine On

  # Allow SvelteKit client assets through
  RewriteRule ^_app/ - [L]
  RewriteRule ^(images|assets|fonts|icons)/ - [L]
  RewriteRule ^(robots\.txt|sitemap\.xml|llms\.txt)$ - [L]

  # Serve real files / folders directly
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # Everything else -> SPA entry
  RewriteRule . /index.html [L]
</IfModule>
